@menu
* Introduction to celine::
* Functions and Variables for celine::
@end menu

@node Introduction to celine, Functions and Variables for celine, celine
@section Introduction to celine

Maxima implementation of Sister Celine's method. Barton Willis wrote this code. It is released under the 
Creative Commons CC0 license (https://creativecommons.org/about/cc0).

Celine's method is described in Sections 4.1--4.4 of the book "A=B", by Marko Petkovsek, Herbert S. Wilf, and Doron Zeilberger.
This book is available at http://www.math.rutgers.edu/~zeilberg/AeqB.pdf 

Let f = F(n,k). The function celine returns a set of recursion relations for F of the form

    p_0(n) * fff(n,k) + p_1(n) * fff(n+1,k) + ... +  p_p(n) * fff(n+p,k+q),

where p_0 through p_p are polynomials. If Maxima is unable to determine that sum(sum(a(i,j) * F(n+i,k+j),i,0,p),j,0,q) / F(n,k) 
is a rational function of n and k, celine returns the empty set. When f involves parameters (variables other than n or k), celine
might make assumptions about these parameters. Using 'put' with a key of 'proviso,' Maxima saves these assumptions on the input 
label.

To use this function, first load the package integer_sequence, opsubst, and to_poly_solve.

Examples:

@example
@group
  (%i1) celine(n!,n,k,1,0);
  (%o1) {fff(n+1,k)-n*fff(n,k)-fff(n,k)}
@end group

Check:
@group
  (%i2) ratsimp(minfactorial(first(%))),fff(n,k) := n!;
  (%o2) 0
@end group

An example with parameters:
@group
  (%i3) e : pochhammer(a,k) * pochhammer(-k,n) / (pochhammer(b,k));
  (%o3) (pochhammer(a,k)*pochhammer(-k,n))/pochhammer(b,k)

  (%i4) recur : celine(e,n,k,2,1);
  (%o4) {fff(n+2,k+1)-fff(n+2,k)-b*fff(n+1,k+1)+n*(-fff(n+1,k+1)+2*fff(n+1,k)-a*fff(n,k)-fff(n,k))+a*(fff(n+1,k)-fff(n,k))+2*fff(n+1,k)-n^2*fff(n,k)}
@end group

Check:
@group
  (%i5) first(%), fff(n,k) := ''(e)$
  (%i6) makefact(makegamma(%))$
  
  (%i7) minfactorial(factor(minfactorial(factor(%))));
  (%o7) 0
@end group

The proviso data suggests that setting a = b may result in a lower order recursion
@group
  (%i8) get('%i4,'proviso);
  (%o8) (-(b-1)*(b-a)*n*(n+a-1)#0) %and ((b-1)*(b-a)*n*(n+a-1)#0) %and (n-b+a#0)

  (%i9) celine(subst(b=a,e),n,k,1,1);
  (%o9) {fff(n+1,k+1)-fff(n+1,k)+n*fff(n,k)+fff(n,k)} 
@end group

@end example
